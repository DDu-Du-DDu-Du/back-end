-- GOAL
CREATE TABLE IF NOT EXISTS goal
(
    id         BIGINT      AUTO_INCREMENT,
    name       VARCHAR(50) NOT NULL,
    color      CHAR(6)     NOT NULL DEFAULT '191919',
    privacy    VARCHAR(20) NOT NULL DEFAULT 'PRIVATE',
    status     VARCHAR(20) NOT NULL DEFAULT 'IN_PROGRESS',
    created_at TIMESTAMP   NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP   NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    is_deleted TINYINT(1)  NOT NULL DEFAULT 0,
    CONSTRAINT pk_goal_id PRIMARY KEY (id),
    CONSTRAINT ck_color CHECK ( CHAR_LENGTH(color) = 6 )
);

-- TO DO
CREATE TABLE IF NOT EXISTS todo
(
    id         BIGINT      AUTO_INCREMENT,
    goal_id    BIGINT      NOT NULL,
    name       VARCHAR(50) NOT NULL,
    status     VARCHAR(20) NOT NULL DEFAULT 'UNCOMPLETED',
    begin_at   TIMESTAMP   NOT NULL DEFAULT CURRENT_TIMESTAMP,
    end_at     TIMESTAMP   NULL,
    created_at TIMESTAMP   NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP   NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    is_deleted TINYINT(1)  NOT NULL DEFAULT 0,
    CONSTRAINT pk_todo_id PRIMARY KEY (id),
    CONSTRAINT fk_goal_id FOREIGN KEY (goal_id) REFERENCES goal (id)
);
